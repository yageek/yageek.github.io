<!doctype html><html lang=en><head><title>Certificate pinning on iOS simulators with iostrust - yageek</title><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><meta content="The personal website of Yannick Heinrich Certificate pinning on iOS simulators with iostrust " name=description><meta content="security, apple, ios, certificates, http, pinning" name=keywords><meta content="Yannick Heinrich - Certificate pinning on iOS simulators with iostrust" property=og:title><meta content=website property=og:type><meta content=https://blog.yageek.net/certificate-pinning-ios-simulators/ property=og:url><meta content="The personal website of Yannick Heinrich" property=og:description><link as=font crossorigin href=https://blog.yageek.net/assets/fonts/FiraCode-Regular.woff2 rel=preload type=font/woff2><link as=font crossorigin href=https://blog.yageek.net/assets/fonts/FiraCode-Bold.woff2 rel=preload type=font/woff2><link href="https://blog.yageek.net/style.css?h=97e262212a0704163528" rel=stylesheet><link href="https://blog.yageek.net/color/green.css?h=c685075d8d57bb1e0d87" rel=stylesheet><link href=https://blog.yageek.net/atom.xml rel=alternate title=RSS type=application/atom+xml><body><div class="container full"><header class=header><div class=header__inner><div class=header__logo><a href=/> <div class=logo>yageek</div> </a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href="
    
        https://blog.yageek.net/about
    
">about</a><li><a href="
    
        https://blog.yageek.net/projects
    
">projects</a><li><a href="
    
        https://speakerdeck.com/yageek
    
">speakerdeck</a><li><a href="
    
        https://github.com/yageek
    
">github</a><li><a href="
    
        https://www.linkedin.com/in/yageek/
    
">linkedin</a><li><a href="
    
        https://www.strava.com/athletes/30110076
    
">strava</a></ul><ul class="menu__inner menu__inner--mobile"><li><a href="
    
        https://blog.yageek.net/about
    
">about</a><li><a href="
    
        https://blog.yageek.net/projects
    
">projects</a><li><a href="
    
        https://speakerdeck.com/yageek
    
">speakerdeck</a><li><a href="
    
        https://github.com/yageek
    
">github</a><li><a href="
    
        https://www.linkedin.com/in/yageek/
    
">linkedin</a><li><a href="
    
        https://www.strava.com/athletes/30110076
    
">strava</a></ul></nav></header><div class=content><article class=post><header><h1 class=post-title><a href=https://blog.yageek.net/certificate-pinning-ios-simulators/>Certificate pinning on iOS simulators with iostrust</a></h1><div class=post-meta><span class=post-date>2015.04.27 </span><span class=post-author></span> :: {<a href=https://blog.yageek.net/categories/security/>security</a>, <a href=https://blog.yageek.net/categories/apple/>apple</a>} :: #<a href=https://blog.yageek.net/tags/ios/>ios</a> #<a href=https://blog.yageek.net/tags/certificates/>certificates</a> #<a href=https://blog.yageek.net/tags/http/>http</a> #<a href=https://blog.yageek.net/tags/pinning/>pinning</a></div></header><p><strong>03.02.2016 Update</strong>: <em>iostrust</em> seems to be broken for Xcode 7. I'm currently trying a new approach to fix this issue.<p>The other day, I published a <a href=https://blog.yageek.net/afnetworking-certificate-pinning-issues/>post</a> on some issues we had regarding certificate pinning and the TLS cache. While the <a href=https://github.com/calabash rel=external>calabash</a> tests were executed, a new issue appears.<p>We have several backends to speak with. Each uses a SSL certificate, not necessarily a certificate signed by a root CA trusted by iOS.<p>As explained on the web, it is not a big deal to add a certificate as a trusted one on the simulators: simply drag and drop the concerned certificate on the simulator window.<p>Our calabash test sequences need to work with fresh new simulators and automatically reset them before starting. By resetting them, we loose all the previous work we did to add the trusted certificates.<p>I started looking if there was another way to automate the process.<p>By having used <a href=https://blog.yageek.net/certificate-pinning-ios-simulators/www.charlesproxy.com/>Charles Proxy</a> in the past, I remembered that using the SSL proxying option required that you install a certificate generated by Charles as a trusted one on the simulator. I also remembered that Charles was able to handle it alone.<p>After looking within the Mac Ox X bundle of the app, I noticed a bash script with an interesting name: <code>install-charles-ca-cert-for-iphone-simulator.sh</code>.<p>By reading it, I understood that the trusted certificates are stored in a sqlite3 database somewhere in the simulator's directories.<p>By Googling a little bit, I discover the <a href=https://github.com/ADVTOOLS/ADVTrustStore rel=external>ADVTrustStore</a> github repository. It contains a script helping you to install certificates from the command line and <a href=https://github.com/ADVTOOLS/ADVTrustStore/blob/master/IOSTrustStore%20Structure.pdf rel=external>a wonderful description</a> on how are trusted certificates handled within the simulators.<p>I wanted to use the python script, but it does not import a certificate directly on all the simulators, it asks for each simulator it founds if you want to install it :(<p>Based on this work and the documentation provided, I wrote a gem that automates all the process.<p>To install it:<pre class=giallo style=color:#cdd6f4;background-color:#1e1e2e><code data-lang=plain><span class=giallo-l><span>$ gem install iostrust</span></span></code></pre><p>If you want to install a certificate as a trusted one, symply run:<pre class=giallo style=color:#cdd6f4;background-color:#1e1e2e><code data-lang=plain><span class=giallo-l><span>$ iostrust add ./my_cert.cer</span></span></code></pre><p>Now you have no excuse to avoid certificate pinning :)</article></div><div class=pagination><div class=pagination__buttons></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026 <a href=https://github.com/ejmg/zerm>zerm</a> :: Powered by <a href=https://www.getzola.org/>Zola</a></span><span>:: Theme made by <a href=https://github.com/ejmg>ejmg</a></span></div><script src=https://blog.yageek.net/assets/js/main.js></script></div></footer></div>
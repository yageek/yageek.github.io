<!doctype html><html lang=en><head><title>Scrollable custom view inside a UIWebView - yageek</title><meta content="text/html; charset=utf-8"http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1"name=viewport><meta content="The personal website of Yannick Heinrich Scrollable custom view inside a UIWebView "name=description><meta content="UI, apple, ios, uikit, scrollview, pinning, objective-c"name=keywords><meta content="Yannick Heinrich - Scrollable custom view inside a UIWebView"property=og:title><meta content=website property=og:type><meta content=https://yageek.net/scrollable-custom-view-inside-a-uiwebview/ property=og:url><meta content="The personal website of Yannick Heinrich"property=og:description><link as=font crossorigin=anonymous href=https://yageek.net/assets/fonts/FiraCode-Regular.woff2 rel=preload type=font/woff2><link as=font crossorigin=anonymous href=https://yageek.net/assets/fonts/FiraCode-Bold.woff2 rel=preload type=font/woff2><link href="https://yageek.net/style.css?h=2c8d17b7aa9535c98dc3b725d1bc9c6b2e12b81df07df95e5d9af6dcb88e7c78"rel=stylesheet><link href="https://yageek.net/color/green.css?h=5a347e8c6d0c143f1dc7bfd18df37abdfa7c3c45951262b9f8b4bcc829a2ab94"rel=stylesheet><body><div class="container full"><header class=header><div class=header__inner><div class=header__logo><a href=/> <div class=logo>yageek</div> </a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href="
    
        https://yageek.net/about
    
">about</a><li><a href="
    
        https://yageek.net/projects
    
">projects</a><li><a href="
    
        https://speakerdeck.com/yageek
    
">talks</a></li><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>show more ▾</li><ul class="menu__sub-inner-more hidden"><li><a href="
    
        https://github.com/yageek
    
">github</a><li><a href="
    
        https://www.linkedin.com/in/yageek/
    
">linkedin</a><li><a href="
    
        https://twitter.com/yageek
    
">twitter</a></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href="
    
        https://yageek.net/about
    
">about</a><li><a href="
    
        https://yageek.net/projects
    
">projects</a><li><a href="
    
        https://speakerdeck.com/yageek
    
">talks</a><li><a href="
    
        https://github.com/yageek
    
">github</a><li><a href="
    
        https://www.linkedin.com/in/yageek/
    
">linkedin</a><li><a href="
    
        https://twitter.com/yageek
    
">twitter</a></ul></nav></header><div class=content><article class=post><header><h1 class=post-title><a href=https://yageek.net/scrollable-custom-view-inside-a-uiwebview/>Scrollable custom view inside a UIWebView</a></h1><div class=post-meta><span class=post-date>2015.02.18 </span><span class=post-author></span> :: {<a href=https://yageek.net/categories/ui/>UI</a>, <a href=https://yageek.net/categories/apple/>apple</a>} :: #<a href=https://yageek.net/tags/ios/>ios</a> #<a href=https://yageek.net/tags/uikit/>uikit</a> #<a href=https://yageek.net/tags/scrollview/>scrollview</a> #<a href=https://yageek.net/tags/pinning/>pinning</a> #<a href=https://yageek.net/tags/objective-c/>objective-c</a></div></header><p>Displaying HTML content is very easy on iOS. Just grab a <code>UIWebView</code> and call <code>loadHTMLString:baseURL</code> or <code>loadData:MIMEType:textEncodingName:baseURL:</code> and enjoy the results. This component would fit your needs 90% of the time. But in some cases, having a simple <code>UIWebView</code> is not enough.<p>For professional reasons, I had to implement a mail reader like screen. On such a screen, there is a fixed portion on the screen that scrolls along with the portion rendering the HTML. I did not build such a view before and start thinking how I could make it.<p>After thinking a little bit, I first thought about implementing the fixed portion in HTML/CSS. No offense to those technologies, but they are not really my cup of tea.<p>I start searching on the Internet to see if someone founds a nice way implementing this without using private APIS.<h1 id=tweaking-the-internal-uiwebbrowserview>Tweaking the internal <code>UIWebBrowserView</code></h1><p>Each <code>UIWebView</code> contains a <code>UIScrolView</code>. Inside this scroll view, the HTML is rendered by a Apple internal private <code>UIView</code> subclass named <code>UIWebBrowserView</code>. It is possible to get a reference to this subview.<p>To have a reference to it, simply loop over the subviews contained within the <code>UIScrollView</code> of the <code>UIWebView</code>:<pre class=language-objective-c data-lang=objective-c style=background-color:#2b303b;color:#c0c5ce;><code class=language-objective-c data-lang=objective-c><span style=color:#b48ead;>for</span><span>(UIView *subview in </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>webView</span><span>.</span><span style=color:#bf616a;>scrollView</span><span>.</span><span style=color:#bf616a;>subviews</span><span>)
</span><span>        {
</span><span>            </span><span style=color:#ebcb8b;>NSString </span><span>* className = </span><span style=color:#96b5b4;>NSStringFromClass</span><span>([subview </span><span style=color:#8fa1b3;>class</span><span>]);
</span><span>            </span><span style=color:#b48ead;>if</span><span>([className </span><span style=color:#8fa1b3;>isEqualToString:</span><span>@"</span><span style=color:#a3be8c;>UIWebBrowserView</span><span>"])
</span><span>            {
</span><span>            	</span><span style=color:#65737e;>//YES ! Just grab a reference to it :)
</span><span>                </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>HTMLRender  </span><span>= subview;
</span><span>
</span><span>                </span><span style=color:#65737e;>//Set the frame of the view to fit your needs
</span><span>                </span><span style=color:#b48ead;>break</span><span>;
</span><span>            }
</span><span>        }
</span></code></pre><p>Once you grab it, you can use and place this view by setting its <code>frame</code>.<p>This works great, but it has the smell of a big workaround :( Would it be possible to do it in a easier way ?<h1 id=do-it-thanks-to-the-documentation>Do it thanks to the documentation</h1><p>I read the article in the great <a href=http://www.objc.io/>objc.io</a> concerning <a href=http://www.objc.io/issue-3/scroll-view.html>scroll views</a> and the start of a solution appears by reading the part <strong>Tweaking the Window with Content Insets</strong>.<p>The main idea is to use the <code>contentInset</code> property of the <code>UIScrollView</code> of the <code>UIWebView</code> to create a space at the top of the <code>UIWebView</code> and fill it with some view.<p>It is better to see with an example. Let's create a <code>UIWebView</code> subclass named <code>AwesomeWebView</code>. This will be a web view with a 100 points red view at this top.<pre class=language-objective-c data-lang=objective-c style=background-color:#2b303b;color:#c0c5ce;><code class=language-objective-c data-lang=objective-c><span style=color:#b48ead;>#define </span><span>TOP_SPACE_HEIGHT </span><span style=color:#d08770;>100.0</span><span style=color:#b48ead;>f
</span><span>
</span><span style=color:#b48ead;>@interface </span><span>AwesomeWebView </span><span style=color:#8fa1b3;>: </span><span style=color:#a3be8c;>UIWebView
</span><span style=color:#b48ead;>@end
</span></code></pre><p>All the work could be done in the initializer. The only thing to consider, is that adding a contentInset create a zone in the view where the coordinates are negatives.<pre class=language-objective-c data-lang=objective-c style=background-color:#2b303b;color:#c0c5ce;><code class=language-objective-c data-lang=objective-c><span>- (</span><span style=color:#b48ead;>id</span><span>) initWithFrame:(CGRect)frame
</span><span>{
</span><span>    </span><span style=color:#b48ead;>if</span><span>(</span><span style=color:#bf616a;>self </span><span>= [</span><span style=color:#bf616a;>super </span><span style=color:#8fa1b3;>initWithFrame:</span><span>frame])
</span><span>    {
</span><span>        [</span><span style=color:#bf616a;>self </span><span style=color:#8fa1b3;>setupScrollView:</span><span>TOP_SPACE_HEIGHT]; </span><span style=color:#65737e;>// Setting the contentInset
</span><span>    }
</span><span>    </span><span style=color:#b48ead;>return </span><span style=color:#bf616a;>self</span><span>;
</span><span>}
</span><span>
</span><span>- (</span><span style=color:#b48ead;>void</span><span>) setupScrollView:(CGFloat)headerHeight
</span><span>{
</span><span>	</span><span style=color:#65737e;>// Set the contentInset to create space for the top View
</span><span>    </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>scrollView</span><span>.</span><span style=color:#bf616a;>contentInset </span><span>= </span><span style=color:#bf616a;>UIEdgeInsetsMake</span><span>(headerHeight, </span><span style=color:#d08770;>0</span><span>, </span><span style=color:#d08770;>0</span><span>, </span><span style=color:#d08770;>0</span><span>);
</span><span>
</span><span>    </span><span style=color:#65737e;>// Set the contentSize
</span><span>    </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>scrollView</span><span>.</span><span style=color:#bf616a;>contentSize </span><span>= (CGSize){</span><span style=color:#bf616a;>CGRectGetWidth</span><span>(</span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>frame</span><span>), </span><span style=color:#bf616a;>CGRectGetHeight</span><span>(</span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>frame</span><span>) + headerHeight};
</span><span>
</span><span>    </span><span style=color:#65737e;>//Make the scroll indicator insets starts at the bottom of the top view
</span><span>    </span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>scrollView</span><span>.</span><span style=color:#bf616a;>scrollIndicatorInsets </span><span>= </span><span style=color:#bf616a;>UIEdgeInsetsMake</span><span>(headerHeight, </span><span style=color:#d08770;>0</span><span>, </span><span style=color:#d08770;>0</span><span>, </span><span style=color:#d08770;>0</span><span>);
</span><span>
</span><span>    </span><span style=color:#65737e;>//Initialize the redTopView
</span><span>    </span><span style=color:#65737e;>//-> Keep in mind that the zone up to the scroll view is negative.
</span><span>    UIView * redView = [[UIView </span><span style=color:#8fa1b3;>alloc</span><span>] initWithFrame:</span><span style=color:#bf616a;>CGRectMake</span><span>(</span><span style=color:#d08770;>0</span><span>, -headerHeight, </span><span style=color:#bf616a;>CGRectGetWidth</span><span>(</span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>frame</span><span>), headerHeight)];
</span><span>    redView.</span><span style=color:#bf616a;>backgroundColor </span><span>= [UIColor </span><span style=color:#8fa1b3;>redColor</span><span>];
</span><span>
</span><span>    </span><span style=color:#65737e;>//Finally add it to the view;
</span><span>    [</span><span style=color:#bf616a;>self</span><span>.</span><span style=color:#bf616a;>scrollView</span><span> addSubview:redView];
</span><span>}
</span></code></pre><p>This methods seems to be better than the first one.<p>You can find an example of this method on <a href=https://github.com/yageek/CustomWebview>github</a></article></div><div class=pagination><div class=pagination__buttons></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 <a href=https://github.com/ejmg/zerm>zerm</a> :: Powered by <a href=https://www.getzola.org/>Zola</a></span><span>:: Theme made by <a href=https://github.com/ejmg>ejmg</a></span></div><script src=https://yageek.net/assets/js/main.js></script></div></footer></div>